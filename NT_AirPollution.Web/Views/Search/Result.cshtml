@using NT_AirPollution.Model.Enum;
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@section styles {
    <link rel="stylesheet" href="@Url.Content("~/static/css/member.css")" />
}
@section scripts {
    <script src="@Url.Content("~/static/js/search/result.js")"></script>
}

<div id="app">
    <div class="main-wrap">
        <el-table :data="forms" :loading="loading" border stripe>
            <el-table-column label="內容" width="60" align="center" fixed>
                <template slot-scope="scope">
                    <el-link type="primary">查看</el-link>
                </template>
            </el-table-column>
            <el-table-column prop="Status" label="案件狀態" align="center" width="120">
                <template slot-scope="scope">
                    <span v-if="scope.row.FormStatus === 4">{{ scope.row.FormStatus | formStatus }}</span>
                    <el-dropdown v-else trigger="click" @@command="handleCommand">
                        <a href="javascript:;" class="el-dropdown-link">
                            {{ scope.row.FormStatus | formStatus }}<i class="el-icon-arrow-down el-icon--right"></i>
                        </a>
                        <el-dropdown-menu slot="dropdown">
                            <el-dropdown-item :disabled="!(scope.row.FormStatus === 3)" :command="beforeCommand(scope.row, 'DOWNLOAD_PAYMENT')">下載繳費單</el-dropdown-item>
                        </el-dropdown-menu>
                    </el-dropdown>
                </template>
            </el-table-column>
            <el-table-column prop="Status" label="結算狀態" align="center" width="120">
                <template slot-scope="scope">
                    <el-dropdown trigger="click" @@command="handleCommand">
                        <a href="javascript:;" class="el-dropdown-link">
                            {{ scope.row.CalcStatus | calcStatus }}<i class="el-icon-arrow-down el-icon--right"></i>
                        </a>
                        <el-dropdown-menu slot="dropdown">
                            <el-dropdown-item :disabled="!(scope.row.CalcStatus === 0 || scope.row.CalcStatus === 2)" :command="beforeCommand(scope.row, 'CALC')">申請結算</el-dropdown-item>
                            <el-dropdown-item :disabled="!(scope.row.CalcStatus === 3)" :command="beforeCommand(scope.row, 'DOWNLOAD_REPAYMENT')">下載繳費單</el-dropdown-item>
                            <el-dropdown-item :disabled="!(scope.row.CalcStatus === 3)" :command="beforeCommand(scope.row, 'UPLOAD_PAYMENT')">上傳繳費證明</el-dropdown-item>
                            <el-dropdown-item :disabled="!(scope.row.CalcStatus === 5)" :command="beforeCommand(scope.row, 'BANK_ACCOUNT')">退費帳戶</el-dropdown-item>
                            <el-dropdown-item :disabled="!(scope.row.CalcStatus > 3)" :command="beforeCommand(scope.row, 'DOWNLOAD_PROOF')">下載結清證明</el-dropdown-item>
                        </el-dropdown-menu>
                    </el-dropdown>
                </template>
            </el-table-column>
            <el-table-column prop="C_NO" label="管制編號" align="center" width="140">
                <template slot-scope="scope">
                    {{ scope.row.C_NO || '(待取號)' }}
                </template>
            </el-table-column>
            <el-table-column prop="SER_NO" label="序號" align="center" width="50"></el-table-column>
            <el-table-column prop="C_DATE" label="申報日期" align="center" width="120">
                <template slot-scope="scope">
                    {{ scope.row.C_DATE | date }}
                </template>
            </el-table-column>
            <el-table-column prop="CreateUserName" label="申請人" align="center" width="120"></el-table-column>
            <el-table-column prop="COMP_NAM" label="工程名稱"></el-table-column>
            <el-table-column prop="PUB_COMP" label="案件類型" align="center" width="100">
                <template slot-scope="scope">
                    {{ scope.row.PUB_COMP ? '公共工程' : '私人工程' }}
                </template>
            </el-table-column>
        </el-table>
    </div>
</div>
